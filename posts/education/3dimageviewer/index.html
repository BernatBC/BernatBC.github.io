<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>3D Image Viewer - BernatBC</title>
<link rel=stylesheet href=https://www.bernatbc.tk/styles/style.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css integrity=sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js integrity=sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body class=dark-theme><div class=page-wrapper><nav class=navbar><div class=navbar-container><button id=navbar-toggle class=navbar-toggle>
<i class="fas fa-bars"></i></button><div class=navbar-nav id=navbar-nav><ul><li><a href=/#profile class=nav-link><i class="fas fa-user"></i> Profile</a></li><li><a href=/#skills class=nav-link><i class="fas fa-code"></i> Skills</a></li><li><a href=/#experiences class=nav-link><i class="fas fa-briefcase"></i> Experiences</a></li><li><a href=/#education class=nav-link><i class="fas fa-graduation-cap"></i> Education</a></li><li><a href=/#projects class=nav-link><i class="fas fa-project-diagram"></i> Open Source Projects</a></li><li><a href=/#recent-posts class=nav-link><i class="fas fa-newspaper"></i> Recent Posts</a></li><li><a href=/posts class="nav-link active"><i class="fas fa-pen"></i> All Posts</a></li></ul></div></div></nav><div class=content-wrapper><aside class=toc-container><div class=toc><h3 class=toc-title><i class="fas fa-list"></i> Table of Contents</h3><div id=toc-content class=toc-content></div></div></aside><div class=main-content><div class=container><article class=post-single><header class=post-header><h1 class=section-title>3D Image Viewer</h1><div class=post-meta><div class=post-meta-top><span class=post-date><i class="far fa-calendar-alt"></i> July 1, 2024</span></div><div class=post-tags><span class=post-tag>Education</span>
<span class=post-tag>JavaScript</span>
<span class=post-tag>OpenSeaDragon</span>
<span class=post-tag>ThreeJS</span></div></div><div class=post-featured-image><img src=/posts/education/3dimageviewer/hero.png alt="3D Image Viewer"></div></header><div class=post-content><h2 id=introduction>Introduction</h2><p>This project was made for my bachelor thesis. You can take a look the full report <a href=https://upcommons.upc.edu/handle/2117/411671>here</a> (note that&rsquo;s in catalan).</p><h2 id=abstract>Abstract</h2><p>Since the arrival of the photographic camera, humans have seen the need to find a way to organize photographs. Nowadays, the ease and simplicity of taking a photograph causes large quantities of them to accumulate. The most popular photo viewers and galleries display one image after another, in a list or grid, making it difficult to organize and searching them.</p><p>One area in which they are aware of this problem is the digitization of cultural heritage. In this area, historians and professional photographers take a large number of photographs at cultural sites and monuments around the world. This area brings added difficulty. In order to preserve the details of the site of interest, the photographs taken are of high quality, requiring an efficient system for less powerful devices.</p><p>This project aims to propose a solution to facilitate the work of searching and organizing images of a place of interest in an efficient manner, such as the church of Sant Quirze de Pedret. I will study the relationship that exists between two-dimensional images and the 3D space where they were captured. Also, the relationship between physical collection spaces and three-dimensional models will be studied.</p><p>With these studies carried out, it is intended to visualize these images taking into account the 3D environment, together with 3D models of the church. The high quality of the photographs makes the fluidity of the solution an important factor to take into account, requiring important optimizations to be applied to the developed product.</p><h2 id=gallery>Gallery</h2><figure><img src=/posts/education/3dimageviewer/hero.png></figure><p style=text-align:center>An overview of the 3D environment created with ThreeJS.</p><figure><img src=/posts/education/3dimageviewer/sphere2.png></figure><p style=text-align:center>An overview of the image viewer created with OpenSeaDragon.</p><h2 id=getting-started-south-apse-with-full-model>Getting Started (South Apse with full model)</h2><h3 id=1-create-directory-structure>1. Create directory structure</h3><p>You&rsquo;ll need to create a <code>public</code> directory in the root of the project. This folder will contain the images, models and data files. The structure of this directory needs to be the following:</p><ul><li>public<ul><li>images<ul><li>low_res</li><li>Sant Quirze de Pedret by Zones</li></ul></li><li>models<ul><li>pedret</li></ul></li><li>out-files<ul><li>MNAC-AbsidiolaSud</li></ul></li></ul></li></ul><h3 id=2-add-full-resolution-pictures>2. Add full resolution pictures</h3><p>Now, add the pictures inside <code>public/images/Sant Quirze de Pedret by Zones</code>. Inside <code>MNAC - South Apse</code> you&rsquo;ll find a directory called <code>Pictoric details and architecture</code>. Please place those pictures into <code>public/images/Sant Quirze de Pedret by Zones/MNAC - South Apse</code>.</p><h3 id=3-create-low-resolution-pictures>3. Create low resolution pictures</h3><p>Copy your <code>public/images/Sant Quirze de Pedret by Zones</code> into <code>public/images/low_res/Sant Quirze de Pedret by Zones</code>. Then copy <code>reducesize.sh</code> inside <code>public/images/low_res/Sant Quirze de Pedret by Zones/MNAC - South Apse</code> and run the script.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x reducesize.sh <span style=color:#75715e># Give execution permissions</span>
</span></span><span style=display:flex><span>./reducesize.sh <span style=color:#75715e># Run the script</span>
</span></span></code></pre></div><p><em>IMPORTANT:</em> This script will override the pictures, so make sure you are running the script against the files located into <em>low_res</em> directory.</p><h3 id=4-create-dzi-pictures>4. Create dzi pictures</h3><p>Now, install <a href=https://github.com/openzoom/deepzoom.py>deepzoom.py</a> following the repo guide. After the installation is completed, please, copy <code>image-to-dzi.py</code> and <code>makeDZI.sh</code> files inside <code>public/images/Sant Quirze de Pedret by Zones</code>. Now, run <code>makeDZI.sh</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x makeDZI.sh <span style=color:#75715e># Give execution permissions</span>
</span></span><span style=display:flex><span>./makeDZI.sh <span style=color:#75715e># Run the script</span>
</span></span></code></pre></div><h3 id=5-place-your-model>5. Place your model</h3><p>Now, add your model <code>pedret_XII_text4K.glb</code> into <code>public/models/pedret</code>. In the case you have a different one, you&rsquo;ll need to change the model name inside <code>main.js</code>.</p><h3 id=6-place-your-bundler-files>6. Place your Bundler files</h3><p>Now, place your <code>MNAC-AbsSud-CamerasRegistration.out</code> inside <code>public/out-files/MNAC-AbsidiolaSud</code>. Then modify the paths of your <code>MNAC-AbsSud-CamerasList.lst</code>. To do so execute <code>convert_picture_list.py</code>. Before running it, modify the paths inside <code>convert_picture_list.py</code> to fit your needs. Place the outputted file into <code>public/out-files/MNAC-AbsidiolaSud</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 convert_picture_list.py <span style=color:#75715e># Run the script</span>
</span></span></code></pre></div><h3 id=proper-structure>Proper structure</h3><p>Your <code>public</code> directory should be similar to:</p><ul><li>public<ul><li>images<ul><li>low_res<ul><li>Sant Quirze de Pedret by Zones<ul><li>MNAC - South Apse<ul><li>*.jpg (10% resolution)</li></ul></li></ul></li></ul></li><li>Sant Quirze de Pedret by Zones<ul><li>MNAC - South Apse<ul><li>*.jpg</li><li>*.dzi</li></ul></li></ul></li></ul></li><li>models<ul><li>pedret<ul><li>pedret_XII_text4K.glb</li></ul></li></ul></li><li>out-files<ul><li>MNAC-AbsidiolaSud<ul><li>MNAC-AbsSud-CamerasRegistration.out</li><li>MNAC-AbsSud-CamerasList-converted.lst</li></ul></li></ul></li></ul></li></ul><h3 id=7-install-dependencies>7. Install dependencies</h3><p>Install node dependencies. Run the following command in the root of the project.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install
</span></span></code></pre></div><h3 id=8-run-the-application>8. Run the application</h3><p>Finally you&rsquo;ll need to start your server, running:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npx vite
</span></span></code></pre></div><p>Once it&rsquo;s loaded, you can open your browser and navigate to <code>http://localhost:5173/</code>. Your URL might be different, so pay attention to the <code>npx vite</code> output.</p><h2 id=demo>Demo</h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/4iaSXIId2zU?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><h3 id=view-code-on><a href=https://github.com/BernatBC/visualitzador-de-fotografies-en-3D>View Code on <i class="fab fa-github"></i>Github</a></h3><h3 id=download-the-report-in><a href=https://upcommons.upc.edu/handle/2117/411671>Download the report in <i class="fa-solid fa-file-pdf"></i>PDF</a></h3></div><div class=post-footer><div class=post-navigation><a href=/posts/contests/junction2023/ class=prev-post><i class="fas fa-arrow-left"></i>
<span><small>Previous</small>
<strong>Junction 2023</strong>
</span></a><a href=/posts/education/vr-battlefield/ class=next-post><span><small>Next</small>
<strong>VR Battlefield</strong>
</span><i class="fas fa-arrow-right"></i></a></div><a href=/posts class=back-to-posts><i class="fas fa-th-list"></i> Back to all posts</a></div></article></div><footer class=footer><div class=footer-contact><a href=bernat.borrasc@gmail.com class=footer-link title=Email><i class="fas fa-envelope"></i>
</a><a href=https://github.com/bernatbc class=footer-link title=Github><i class="fab fa-github"></i>
</a><a href=https://www.youtube.com/channel/UCWuKGhwo6zB_ptObwrumZXw class=footer-link title=Youtube><i class="fa-brands fa-youtube"></i>
</a><a href=https://www.linkedin.com/in/bernat-borr%c3%a0s-i-civil/ class=footer-link title=LinkedIn><i class="fab fa-linkedin"></i>
</a><a href=https://devpost.com/bernat-borras-civil class=footer-link title=Devpost><i class="fa-solid fa-d"></i></a></div><div class=footer-copyright><p>© 2025 Copyright.</p><p>Powered by <a href=https://gohugo.io target=_blank>gohugo</a></p></div></footer></div></div></div><script>document.addEventListener("DOMContentLoaded",function(){const s=document.getElementById("navbar-toggle"),o=document.getElementById("navbar-nav");s.addEventListener("click",function(){o.classList.toggle("show")}),document.querySelectorAll("pre > code").forEach(function(e){const t=document.createElement("button");t.className="copy-code-button",t.type="button",t.innerHTML='<i class="fas fa-copy"></i> Copy';const s=e.parentNode,n=document.createElement("div");n.className="code-block-wrapper";const o=e.className;if(o&&o.startsWith("language-")){const e=o.replace("language-","");n.setAttribute("data-lang",e)}s.parentNode.insertBefore(n,s),n.appendChild(s),n.appendChild(t),t.addEventListener("click",function(){navigator.clipboard.writeText(e.textContent).then(function(){t.innerHTML='<i class="fas fa-check"></i> Copied!',setTimeout(function(){t.innerHTML='<i class="fas fa-copy"></i> Copy'},2e3)},function(){t.innerHTML='<i class="fas fa-times"></i> Error',setTimeout(function(){t.innerHTML='<i class="fas fa-copy"></i> Copy'},2e3)})})});const e=document.querySelector(".post-content"),t=document.getElementById("toc-content");if(e&&t){const n=e.querySelectorAll("h2, h3, h4");if(n.length>0){const e=document.createElement("ul");n.forEach((t,n)=>{t.id||(t.id="heading-"+n);const o=document.createElement("li");o.className="toc-"+t.tagName.toLowerCase();const s=document.createElement("a");s.href="#"+t.id,s.textContent=t.textContent,o.appendChild(s),e.appendChild(o),s.addEventListener("click",function(e){e.preventDefault(),document.getElementById(t.id).scrollIntoView({behavior:"smooth"}),history.pushState(null,null,"#"+t.id)})}),t.appendChild(e)}else document.querySelector(".toc-container").style.display="none"}const n=document.querySelectorAll(".toc-content a");n.length&&window.addEventListener("scroll",function(){let e=null;const t=window.scrollY;document.querySelectorAll(".post-content h1, .post-content h2, .post-content h3, .post-content h4").forEach(n=>{const s=n.offsetTop;s-100<=t&&(e=document.querySelector(`.toc-content a[href="#${n.id}"]`))}),n.forEach(e=>{e.classList.remove("active")}),e&&e.classList.add("active")})})</script></body></html>